worker_processes  12;
error_log stderr notice;
daemon off;
pid /tmp/nginx.pid;

worker_cpu_affinity
000000000001000000000000
000000000010000000000000
000000000100000000000000
000000001000000000000000
000000010000000000000000
000000100000000000000000
000001000000000000000000
000010000000000000000000
000100000000000000000000
001000000000000000000000
010000000000000000000000
100000000000000000000000;

events {
    worker_connections 32768;
    use epoll;
    multi_accept off;
    accept_mutex off;
}

http {
     send_timeout       600s;
     sendfile           on;
     tcp_nopush         on;
     tcp_nodelay        on;
     directio           2m;
     lingering_close    off;
     lingering_time     0s;
     output_buffers     8 4k;

     client_header_timeout            15;
     client_body_timeout              15;
     keepalive_timeout                46;
     keepalive_requests      99999999999;

     access_log off;

     server {
        listen 8181 default fastopen=128 bind backlog=16384;
        location / {
            default_type text/html;
            content_by_lua '
            ngx.say(string.rep("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx ", 128))
            ';
        }
    }
}
